{"version":3,"sources":["lib/generateLoaderContent/index.js"],"names":["generateLoaderContent","byLocale","a","b","ta","tb","files","chunk","usedLang","cases","sort","map","f","basename","replace","locale","lang","split","padding","code","langDefaultCase","join"],"mappings":";;;;;;;;;;;;kBAsBwBA,qB;;AAtBxB;;;;AACA;;;;;;AAEA,SAASC,QAAT,CAAkBC,CAAlB,EAAqBC,CAArB,EAAwB;AACtB,MAAMC,KAAK,4BAAaF,CAAb,CAAX;AACA,MAAMG,KAAK,4BAAaF,CAAb,CAAX;AACA,MAAIC,OAAOC,EAAX,EAAe,OAAO,CAAP;AACf,SAAOD,KAAKC,EAAL,GACL,CADK,GAEL,CAAC,CAFH;AAGD;AACD;;;;;;AAMA;;;;;AAKe,SAASL,qBAAT,EAA+B,yBAA/B,MAGZ;AAAA,MAFDM,KAEC,QAFDA,KAEC;AAAA,wBADDC,KACC;AAAA,MADDA,KACC,8BADO,IACP;;AACD,MAAMC,WAAW,EAAjB;AACA,MAAMC,QAAQH,MAAMI,IAAN,CAAWT,QAAX,EAAqBU,GAArB,CAAyB,UAACC,CAAD,EAAO;AAC5C,QAAMC,WAAWD,EAAEE,OAAF,CAAU,eAAV,EAA2B,EAA3B,CAAjB;AACA,QAAMC,SAAS,4BAAaF,QAAb,CAAf;AACA,QAAMG,OAAOD,OAAOE,KAAP,CAAa,GAAb,EAAkB,CAAlB,CAAb;AACA,QAAMC,UAAUX,QAAQ,IAAR,GAAe,EAA/B;AACA,QAAIY,0BACMD,OADN,iCACwCL,QADxC,0BAEMK,OAFN,6DAAJ;AAGA,QAAIX,KAAJ,EAAW;AACTY,iHAE6BN,QAF7B,2BAE0DM,IAF1D,6BAGcJ,MAHd,kCAIgBI,IAJhB;AAMD;AACD,QAAIC,kBAAkB,EAAtB;AACA,QAAI,CAACZ,SAASQ,IAAT,CAAL,EAAqB;AACnBR,eAASQ,IAAT,IAAiB,IAAjB;AACAI,8CACUJ,IADV;AAGD;AACD,WAAUI,eAAV,2BACcL,MADd,aAC2BI,IAD3B;AAID,GA3Ba,CAAd;AA4BA,gDAEyBV,MAAMY,IAAN,CAAW,EAAX,CAFzB;AASD","file":"index.js","sourcesContent":["import dedent from 'dedent';\r\nimport formatLocale from '../formatLocale';\r\n\r\nfunction byLocale(a, b) {\r\n  const ta = formatLocale(a);\r\n  const tb = formatLocale(b);\r\n  if (ta === tb) return 0;\r\n  return ta > tb ?\r\n    1 :\r\n    -1;\r\n}\r\n/**\r\n * @typedef GLCOptions\r\n * @property {String[]} files\r\n * @property {Boolean} [chunk]\r\n *\r\n */\r\n/**\r\n * @function\r\n * @description Generate js code for localeLoader according the files listed.\r\n * @param {GLCOptions} options\r\n */\r\nexport default function generateLoaderContent(/** @type {GLCOptions} */ {\r\n  files,\r\n  chunk = true,\r\n}) {\r\n  const usedLang = {};\r\n  const cases = files.sort(byLocale).map((f) => {\r\n    const basename = f.replace(/\\.(js|json)$/i, '');\r\n    const locale = formatLocale(basename);\r\n    const lang = locale.split('-')[0];\r\n    const padding = chunk ? '  ' : '';\r\n    let code = `\r\n            ${padding}const data = require('./${basename}');\r\n            ${padding}resolve(data.__esModule === true ? data.default : data);`;\r\n    if (chunk) {\r\n      code = `\r\n            if (typeof require.ensure === 'function') {\r\n              require.ensure(['./${basename}'], (require) => {${code}\r\n              }, '${locale}');\r\n            } else {${code}\r\n            }`;\r\n    }\r\n    let langDefaultCase = '';\r\n    if (!usedLang[lang]) {\r\n      usedLang[lang] = true;\r\n      langDefaultCase = `\r\n        case '${lang}':\r\n      `;\r\n    }\r\n    return `${langDefaultCase}\r\n          case '${locale}': {${code}\r\n            break;\r\n          }`;\r\n  });\r\n  return dedent`export default function loadLocale(locale) {\r\n      return new Promise((resolve) => {\r\n        switch (locale) {${cases.join('')}\r\n          default:\r\n            resolve({});\r\n            break;\r\n        }\r\n      });\r\n    }\\n`;\r\n}\r\n"]}